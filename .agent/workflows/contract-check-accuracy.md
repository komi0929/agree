---
description: 契約書チェック精度に関するドキュメントを確認・更新する
---

# 契約書チェック精度管理プロトコル

## チェック精度の重要性

**契約書チェック精度は、このサービスの存在意義そのものです。**

精度が低下すると：
- ユーザーが法的リスクを見逃す可能性がある
- 訴訟問題に発展するリスクがある
- サービスの信頼性が完全に失われる

## 必須チェック項目（28項目）

### 最重要6項目（必ず検出すべき）

1. **支払期日（60日ルール）** - フリーランス新法第4条
2. **著作権の移転（27条・28条の特掲）** - 著作権法第61条第2項
3. **損害賠償の上限**
4. **禁止行為** - フリーランス新法第5条
5. **偽装請負リスク**
6. **競業避止義務**

### 欠落チェック項目

- 支払期日の明確な規定
- 損害賠償の上限規定
- 著作権の帰属に関する規定
- 契約解除の条件

## 精度に関するファイル

以下のファイルは精度に直接影響する：

| ファイル | 影響度 | 説明 |
|---------|-------|------|
| `lib/ai-service.ts` | **最重要** | AIプロンプト・解析ロジック |
| `app/api/analyze-stream/route.ts` | **重要** | ストリーミングAPI（同じプロンプト使用） |
| `lib/rules/rule-checker.ts` | 高 | ルールベースチェック |
| `lib/knowledge/known-bad-patterns.ts` | 高 | 危険パターン定義 |

## 精度変更時の確認事項

1. 同じ契約書で変更前後の検出件数を比較
2. 最重要6項目が全て検出されることを確認
3. false negative（見逃し）がないことを確認

## 2026年1月7日のインシデント

Streaming API作成時にプロンプトを「簡略化」した結果：
- 検出件数: 10件超 → 3件に激減
- 原因: 詳細なチェック指示が省略されていた
- 対策: フルプロンプトに復元 + 保護ワークフロー作成
